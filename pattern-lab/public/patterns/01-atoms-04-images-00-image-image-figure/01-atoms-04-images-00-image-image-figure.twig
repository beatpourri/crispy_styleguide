{#
/**
 * Available variables:
 * - img_src - image file location
 * - img_alt - (optional) the alt text for screen readers - if empty output is: ' alt="" '
 * - image_base_class - base class name
 * - image_element_class - element class name
 * - image_modifiers - modifiers
 * - figure_base_class
 * - figure_element_class
 * - figure_modifiers
 * - image_link_base_class - base class for link
 * - image_url - url for link
 * - image_link_modifiers - modifiers for image link
 * - image_link_base_class - base class for the image link
 * - image_link_attributes - attributes key/value pair for link attributes
 * - img_fix
 * - img_suffix
 * Usage:
 * "default" image (without a link):
 * {%  include "@atoms/04-images/00-image/image.twig"
 * with {
 * "img_src": "sourceoftheimage",
 * "img_alt": "image alt text",
 * }
 * %}
 *
 * customized classes:
 * {%  include "@atoms/04-images/00-image/image.twig"
 * with {
 * "img_src": "sourceoftheimage",
 * "img_alt": "yourimagealttext",
 * "image_base_class": "yourbaseclassoverwrite",
 * "image_element_class": "youreelementclassoverwrite",
 * "image_modifiers": ['modifier1', 'modifier2'],
 * }
 * %}
 * image with a link:
 * {%  include "@atoms/04-images/00-image/image.twig"
 * with {
 * "img_src": "../../images/dummy_img_400.png",
 * "img_url": "urltolinkto",
 * "img_alt": "yourimagealttext",
 * }
 * %}
 * customized classes:
 *
 * {%  include "@atoms/04-images/00-image/image.twig"
 * with {
 * "img_src": "../../images/dummy_img_400.png",
 * "img_url": "urltolinkto",
 * "image_base_class": "yourbaseclassoverwrite",
 * "image_element_class": "youreelementclassoverwrite",
 * "image_modifiers": ['modifier1', 'modifier2'],
 * "image_link_element_class": "your_image_link_element_class_overwrite",
 * "link_base_class": "link_base_class_overwrite",
 * link_element_class
 * "image_link_target_value": "_blank",
 * "image_link_title_value": "link title text",
 * }
 * %}
 *
*
* Image example (Drupal):
*
* {% include "@atoms/04-images/00-image/image-figure.twig"
* with {
* "img_src": content.field_image[0]['#media'].field_media_image.entity.uri.value | image_style('teaser'),
* "img_alt": node.field_image.0.entity.field_media_image.0.alt,
* "figcaption_text": node.field_image.0.entity.field_caption_text.0.value,
* "image_element_class": node.bundle,
* "image_modifiers": [view_mode],
* }
* %}
*
* Responsive image example (Drupal):
*
* {% include "@atoms/04-images/00-image/image-figure.twig"
* with {
* "img_responsive": drupal_entity('media', '8', 'teaser_image'),
* "img_alt": node.field_image.0.entity.field_media_image.0.alt,
* "figcaption_text": node.field_image.0.entity.field_caption_text.0.value,
* "image_element_class": node.bundle,
* "image_modifiers": [view_mode],
* }
* %}
* Paragraphs example:
*
* {% include "@atoms/04-images/00-image/image-figure.twig"
* with {
* "img_responsive": content.field_component_image,
* "img_alt": content.field_component_image[0]['#media'].field_media_image.value.alt,
* "figcaption_text": content.field_component_image[0]['#media'].field_caption_text.value,
* "image_element_class": node.bundle,
* "image_modifiers": [view_mode],
* }
* %}
*
*/
#}
{% set image_base_class = image_base_class|default('image') %}
{% set image_element_class = image_element_class|default('') %}
{% set image_modifiers = image_modifiers|default([]) %}
{% set image_link_base_class = image_link_base_class|default('image') %}
{% set image_link_element_class = image_link_element_class|default(image_element_class) %}

{% set figure_base_class = figure_base_class|default('figure') %}
{% set figure_element_class = figure_element_class|default(image_element_class) %}
{% set figure_modifiers = figure_modifiers|default(image_modifiers) %}
{% set figcaption_class = figcaption_class|default('figcaption') %}


{% set link_base_class = link_base_class|default('link') %}
{% set link_element_class = link_element_class|default(image_link_base_class) %}
{% set link_modifiers = link_modifiers|default(image_link_element_class) %}
{% set figcaption_text = figcaption_text|default('') %}
{% set img_src = img_src|default('') %}
{% set img_alt = img_alt|default('') %}
{% set image_url = image_url|default('') %}
{% set image_link_target_value = image_link_target_value|default('') %}
{% set image_link_title_value = image_link_title_value|default('') %}
{% set image_link_modifiers = image_link_modifiers|default(image_modifiers|merge(['link'])) %}

{% set image_modifier %}
  {% spaceless %}
    {% if image_url %}
      {% if image_modifiers  %}
        {% for imageitem in image_link_modifiers %}{{ image_link_base_class }}__{{ image_link_element_class }}--{{ imageitem }} {% endfor %}
      {% else %}
        {{ image_link_base_class }}--link
      {% endif %}
    {% else %}
      {% spaceless %}
        {% if image_modifiers %}
          {% for imageitem in image_modifiers %}{{ image_base_class }}__{{ image_element_class }}--{{ imageitem }} {% endfor %}
        {% else %}

        {% endif %}
      {% endspaceless %}
    {% endif %}
  {% endspaceless %}
{% endset %}
{% set image_classes %}
  {% spaceless %}
    {% if image_url %}
      class="{{ image_link_base_class|clean_class }}{% if image_link_element_class %} {{ image_link_base_class }}__{{ image_link_element_class }}{% endif %}{% if image_modifier %}{{ image_modifier }}{% endif %}"
    {% else %}
      class="{{ image_base_class|clean_class }}{% if image_element_class %} {{ image_base_class }}__{{ image_element_class }}{% endif %}{%- if image_modifier -%}{{ image_modifier }}{% endif %}"
    {% endif %}
  {% endspaceless %}
{% endset %}

{% set figure_modifier %}
  {% spaceless %}
    {% if image_url %}
      {% if figure_modifiers  %}
        {% for figureitem in figure_modifiers %}{{ figure_base_class }}__{{ figure_element_class }}--{{ figureitem }} {% endfor %}
      {% else %}
        {{ figure_base_class }}--link
      {% endif %}
    {% else %}
      {% spaceless %}
        {% if figure_modifiers %}
          {% for figureitem in figure_modifiers %}{{ figure_base_class }}__{{ figure_element_class }}--{{ figureitem }} {% endfor %}
        {% else %}

        {% endif %}
      {% endspaceless %}
    {% endif %}
  {% endspaceless %}
{% endset %}

{% set figure_classes %}
  {% spaceless %}
    class="{{ figure_base_class|clean_class }}{% if figure_element_class %} {{ figure_base_class }}__{{ figure_element_class }}{% endif %}{%- if figure_modifier -%}{{ figure_modifier }}{% endif %}"
  {% endspaceless %}
{% endset %}

{% if image_url %}
  {% embed "@atoms/02-link/link/01-link.twig" with {
  "link_url": image_url,
  "link_target_value": image_link_target_value,
  "link_title_value": image_link_title_value,
  "link_base_class": link_base_class,
  "link_element_class": link_element_class,
  "link_modifiers": link_modifiers,
  } %}
    {% block link_content %}
      {{ img_prefix }}
      <figure {{ figure_classes }}>
          {% include "@atoms/04-images/00-image/_image_plain.twig" %}
          {% if figcaption_text %}
              <figcaption class="{{ figcaption_class }}">
                {{ figcaption_text }}
              </figcaption>
          {% endif %}
      </figure>
      {{ img_suffix }}
    {% endblock %}
  {% endembed %}
{% else %}
  {{ img_prefix }}
  <figure {{ figure_classes }}>
      {% include "@atoms/04-images/00-image/_image_plain.twig" %}
        {% if figcaption_text %}
          <figcaption class="{{ figcaption_class }}">
            {{ figcaption_text }}
          </figcaption>
        {% endif %}
  </figure>
  {{ img_suffix }}
{% endif %}